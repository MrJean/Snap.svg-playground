<html>
    <head>
        <title>Windspeed</title>
        <style type="text/css">
            svg { max-width: 100px; }
        </style>
    </head>
    <body>
        <svg id="windmill"></svg>
        <svg id="windmillYellow"></svg>
        <svg id="windmillRed"></svg>
        <svg id="thermometer"></svg>
        <svg id="windmeter"></svg>
        <svg id="humidity"></svg>

        <script src="scripts/snap.svg-min.js"></script>
        <script src="scripts/windmill.snapsvg.js"></script>
        <script src="scripts/thermometer.snapsvg.js"></script>
        <script src="scripts/beaufort.snapsvg.js"></script>

        <script>
            
            (function() {
                
                var windmillGray = new Windmill({
                    fill: '#999',
                    speed: 10000
                });

                var windmillYellow = new Windmill({
                    element: '#windmillYellow',
                    fill: 'Yellow',
                    speed: 4000
                });

                var windmillRed = new Windmill({
                    element: '#windmillRed',
                    fill: 'Red',
                    speed: 3000
                });

                var thermometer = new Thermometer();
                thermometer.setTemperature(5);

                var windmeter = new Beaufort();
                windmeter.setBeaufort(1);

                // ***
                // Humidity
                // ***
                humidity = (function() {
                    
                    var humimdity = 0;
                    var drop = undefined;
                    var dropsPos = [
                        [ 't25,-2s,s0.55,0.55', 't25,0s,s0.55,0.55' ],
                        [ 't12,-27s,s0.7,0.7', 't12,-25s,s0.7,0.7' ], 
                        [ 't-10,-10s,s0.6,0.6', 't-10,-8s,s0.6,0.6' ]
                    ];
                    var drops = [];
                    
                    function drawDrop() {
                        var surface = Snap("#humidity");
                        surface.attr({ viewBox: "0 0 100 100" });
                        
                        drop = surface.path("M30,50 A11,11 0 1,0 50,50 L40,35 z").attr({
                            stroke: '#000',
                            strokeWidth: 2,
                            fill: 'none'
                        });
                    }
                    
                    function clearHumidity() {
                        for (i = 0; i < drops.length; i++) {
                            drops[i].animate({
                                strokeWidth: 0
                            }, 100, function() {
                                this.remove();
                            });
                        }
                    }
                    
                    function adjustHumidity() {
                        clearHumidity();
                        for (i = 0; i < humimdity; i++) {
                            var extraDrop = drop.clone();
                            drops[i] = extraDrop;
                            extraDrop.attr({
                                transform: dropsPos[i][0],
                                strokeWidth: 0
                            }).animate({
                                transform: dropsPos[i][1],
                                strokeWidth: 2
                            }, 1000);
                        }
                    }
                    
                    return {
                        draw : function() {
                            drawDrop();
                        },
                        
                        changeHumidity : function() {
                            humimdity = Math.floor(Math.random() * 4);
                            adjustHumidity();
                        }
                    }
                    
                })();
                
                humidity.draw();
                
            })();            
            
        </script>
    </body>
</html>